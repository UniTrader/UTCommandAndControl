<?xml version="1.0" encoding="UTF-8"?>
<mdscript xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" name="UT_CAC_Debug_Out" xsi:noNamespaceSchemaLocation="http://utnas/~unitrader/XRebirthxsds/md.xsd">
  <cues>
    <cue name="Player_docked">
      <conditions>
        <event_object_changed_room object="player.entity"/>
        <check_value value="player.entity.container != player.primaryship"/>
      </conditions>
      <actions>
        <remove_help all="true"/>
        <show_help custom="'Debug Events registered to \n%1'.[player.entity.container.knownname]" position="11" duration="20s"/>
        <reset_cue cue="Player_Undocked"/>
      </actions>
      <cues>
        <cue name="Player_docked_events" instantiate="true">
          <conditions>
            <check_any>
              <event_object_approaching_waypoint object="player.entity.container"/>
              <event_object_arrived_at_waypoint object="player.entity.container"/>
              <event_object_attacked object="player.entity.container"/>
              <event_object_collided object="player.entity.container"/>
              <event_object_enemy_found object="player.entity.container"/>
              <event_object_incoming_missile object="player.entity.container"/>
              <event_object_killed_object object="player.entity.container"/>
              <event_object_launched_missile object="player.entity.container"/>
              <event_object_signalled object="player.entity.container"/>
            </check_any>
          </conditions>
          <actions>
            <!-- make params readable if possible -->
            <substitute_text text="$eventname" source="event.name">
              <replace string="'event_object_'" with="'e_o_'"/>
              <replace string="'event_player_'" with="'e_p_'"/>
            </substitute_text>
            <set_value name="$objectname" exact="if event.object.controlentity.$shortname? then event.object.controlentity.$shortname else event.object.knownname"/>
            <set_value name="$param" exact="event.param + ''"/>
            <set_value name="$param" exact="event.param + ''"/>
            <set_value name="$param2" exact="event.param2 + ''"/>
            <set_value name="$param3" exact="event.param3 + ''"/>
            <!-- Object Params - print Name -->
            <do_if value="typeof event.param == datatype.component">
              <set_value name="$param" exact="if event.param.controlentity.$shortname? then event.param.controlentity.$shortname else event.param.knownname"/>
            </do_if>
            <do_if value="typeof event.param2 == datatype.component">
              <set_value name="$param2" exact="if event.param2.controlentity.$shortname? then event.param2.controlentity.$shortname else event.param2.knownname"/>
            </do_if>
            <do_if value="typeof event.param3 == datatype.component">
              <set_value name="$param3" exact="if event.param3.controlentity.$shortname? then event.param3.controlentity.$shortname else event.param3.knownname"/>
            </do_if>
            <do_if value="event.name == 'event_object_signalled'">
              <do_if value="event.param != 'Object Name Updated'">
                <show_notification caption="player.age + ' / ' + $param" details="[$param2,'','#####################',$param3]" timeout="3s" queued="true"/>
              </do_if>
            </do_if>
            <do_else>
              <remove_help all="true"/>
              <show_help custom="'%1\n%2\n%3\n%4\n%5\n%6'.[player.age,$eventname,$objectname,$param,$param2,$param3]" position="11" duration="20s"/>
            </do_else>
          </actions>
        </cue>
      </cues>
    </cue>
    <cue name="Player_Undocked" comment="Player Undocked: stop Platform Scripts and reset cue for player wait until docked again">
      <conditions>
        <event_object_changed_room object="player.entity"/>
        <check_value value="player.entity.container == player.primaryship" comment="Only if player is on his ship"/>
      </conditions>
      <actions>
        <remove_help all="true"/>
        <show_help custom="'Debug Events unregistered'" position="11" duration="20s"/>
        <reset_cue cue="Player_Docked"/>
      </actions>
    </cue>
  </cues>
</mdscript>
